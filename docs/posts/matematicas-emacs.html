<?xml version="1.0" encoding="utf-8"?>
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-04-25 Sat 12:12 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Matem치ticas en Emacs</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Mario Rom치n" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" href="../css/default.css" />
<link rel="stylesheet" href="../css/mathjax_fonts.css" />
<link rel="stylesheet" href="../css/syntax.css" />
<div id="header">
<div id="logo">
<a hrwef="../index.html">Mario Rom치n</a>
</div>
<div id="navigation">
<a href="../index.html">About</a>
<a href="../posts/index.html">Blog</a>
<a href="https://github.com/mroman42/">Github</a>
</div>
</div>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.cacheClassElem = elem.className;
         elem.cacheClassTarget = target.className;
         target.className = "code-highlighted";
         elem.className   = "code-highlighted";
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(elem.cacheClassElem)
         elem.className = elem.cacheClassElem;
       if(elem.cacheClassTarget)
         target.className = elem.cacheClassTarget;
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Matem치ticas en Emacs</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgef2de3f">Apuntes a ordenador</a></li>
<li><a href="#org3c90816">Ventajas de org-mode</a></li>
<li><a href="#org9ca68a7">Zoom</a></li>
<li><a href="#org3eaf109">Aumentando la velocidad de escritura</a></li>
<li><a href="#org930bd5c">Diagramas conmutativos</a></li>
<li><a href="#orgde94d08">Cabeceras en Latex</a></li>
<li><a href="#org8dea95a">Archivos de configuraci칩n de org</a></li>
<li><a href="#org8e83040">Ejemplos</a></li>
</ul>
</div>
</div>
<p>
<i>Actualizado a 06 de agosto de 2017.</i>
</p>

<div id="outline-container-orgef2de3f" class="outline-2">
<h2 id="orgef2de3f">Apuntes a ordenador</h2>
<div class="outline-text-2" id="text-orgef2de3f">
<p>
Tomar apuntes de matem치ticas con el ordenador es una tarea dif칤cil por
lo complejo que es transcribir la notaci칩n (s칤mbolos, letras en otros
alfabetos, 칤ndices&#x2026;) y la velocidad necesaria. Adem치s, los
diagramas, dibujos, flechas o anotaciones no textuales que tomamos
parecen imposibles de transcribir fielmente a un fichero.
</p>

<p>
<b><a href="https://www.latex-project.org/about/">Latex</a></b> permite notaci칩n matem치tica pero no facilita la velocidad (al fin y
al cabo, Latex estar칤a pensado para edici칩n de libros, no para tomar apuntes).
<b><a href="https://daringfireball.net/projects/markdown/">Markdown</a></b>, por otro lado, simplifica mucho el poder escribir, pero pierde mucha 
potencia respecto a Latex. As칤 que una soluci칩n es usar <b><a href="http://orgmode.org/">org-mode</a></b> como lenguaje
de marcado; es relativamente simple y f치cilmente legible, como markdown, mientras
que permite visualizaci칩n de latex conforme se edita, programaci칩n literaria y
exportaci칩n a latex y html, permitiendo la inclusi칩n de c칩digo latex o html arbitrario
para exportarlo.
</p>
</div>
</div>

<div id="outline-container-org3c90816" class="outline-2">
<h2 id="org3c90816">Ventajas de org-mode</h2>
<div class="outline-text-2" id="text-org3c90816">
<p>
<b>org-mode</b> tiene internamente un lenguaje de marcado similar al de
markdown, con la ventaja para el usuario de Emacs de que est치 adaptado
especialmente al editor. Permite escribir f칩rmulas en Latex y exportar
luego a <code>.tex</code> y <code>.pdf</code>, controlando las opciones de Latex.
</p>

<p>
Una f칩rmula en Latex puede escribirse directamente en <b>org-mode</b>
incluy칠ndola entre \(\mathtt{\backslash\left( \dots \backslash\right)}\), si est치 dentro de una l칤nea de texto 
(como en \(i \ast x = x\)); o entre \(\backslash[\ \dots\ \backslash]\), cuando
queremos que se muestre aparte del texto como en el siguiente ejemplo
</p>

<p>
\[ \sum_{n=0}^\infty \frac{1}{2^n}. \]
</p>

<p>
Cuando terminamos de escribirla podemos <a href="http://orgmode.org/worg/org-tutorials/org-latex-preview.html">previsualizarla</a> directamente con
<code>C-c C-x C-l</code>, como si fuera un editor <a href="https://es.wikipedia.org/wiki/WYSIWYG">WYSIWYG</a>.
</p>

<p>
Si vamos a acabar exportando a latex podemos insertar entornos como los
que ofrece la biblioteca de la AMS con
</p>

<pre class="example">
#+begin_theorem
[texto del teorema]
#+end_theorem
</pre>

<p>
o incluso definir nuestros propios entornos y usarlos despu칠s de la misma
forma. Adem치s, tambi칠n permite la inclusi칩n de bloques de c칩digo con
</p>

<pre class="example">
#+begin_src ruby
[c칩digo en ruby]
#+end_src
</pre>

<p>
en la mayor칤a de lenguajes de programaci칩n y algunos especialmente 칰tiles
para matem치ticas como <code>Sage</code>.
</p>
</div>
</div>

<div id="outline-container-org9ca68a7" class="outline-2">
<h2 id="org9ca68a7">Zoom</h2>
<div class="outline-text-2" id="text-org9ca68a7">
<p>
Un problema menor (y quiz치 s칩lo m칤o) al configurar todo esto es que
las f칩rmulas previsualizadas parecen demasiado peque침as. Aunque est칠n
en proporci칩n con el texto, cuesta m치s leerlas; y cuando aumentamos el
tama침o del texto con <code>C-x C-+</code>, las f칩rmulas no se ampl칤an con
칠l. Para conseguir que lo hagan hay que incluir el siguiente trozo de
c칩digo en el archivo de configuraci칩n de Emacs, mezcla de dos
respuestas de <a href="http://emacs.stackexchange.com/questions/3387/how-to-enlarge-latex-fragments-in-org-mode-at-the-same-time-as-the-buffer-text">thisirs y Mark</a> en Stack Overflow:
</p>

<div class="org-src-container">
<pre class="src src-lisp">  (<span style="color: #81A1C1;">defun</span> <span style="color: #8FBCBB;">update-org-latex-fragment-scale</span> ()
    (<span style="color: #81A1C1;">let</span> ((text-scale-factor
           (expt text-scale-mode-step text-scale-mode-amount)))
      (plist-put org-format-latex-options
                 <span style="color: #8FBCBB;">:scale</span> (* <span style="color: #B48EAD; font-weight: bold;">1.2</span> text-scale-factor)))
  )
  (add-hook
   'text-scale-mode-hook
   'update-org-latex-fragment-scale)
</pre>
</div>

<p>
Despu칠s de volver a cargar el archivo de configuraci칩n, las f칩rmulas nuevas
deber칤an volver a ajustarse con el texto.
</p>
</div>
</div>

<div id="outline-container-org3eaf109" class="outline-2">
<h2 id="org3eaf109">Aumentando la velocidad de escritura</h2>
<div class="outline-text-2" id="text-org3eaf109">
<p>
Mi objetivo principal con todo esto era escribir matem치ticas m치s
r치pidamente, as칤 que <a href="http://emacs.stackexchange.com/questions/26322/math-autocompletion-in-org-mode">pregunt칠 sobre autocompletado</a> y conclu칤 en usar
<code>latex-math-mode</code>. Esto permite incluir comandos de Latex con atajos
de teclado. En su configuraci칩n original usa el caracter <code>`</code> para
acceder a ellos, as칤 que <code>`-a</code> escribe <code>\alpha</code>.  Yo he decidido
cambiar el acento invertido, que ya cuesta dos pulsaciones en el
teclado en espa침ol, por la <code>칞</code>, que no la suelo usar. Adem치s de los
que incluye el paquete por defecto, se pueden escribir atajos propios.
</p>

<p>
Adem치s de <code>latex-math-mode</code>, <code>cdlatex</code> es un modo de Emacs escrito
por el mismo creador de org-mode, que facilita la escritura r치pida
de s칤mbolos de latex. Puede a침adirse a <code>org-mode</code> usando
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">use-package</span> cdlatex
    <span style="color: #8FBCBB;">:ensure</span> t<span style="color: #81A1C1;">)</span>

  <span style="color: #81A1C1;">(</span><span style="color: #8FBCBB;">add-hook</span> <span style="color: #81A1C1;">'</span><span style="color: #d9c6d6;">org-mode-hook</span> <span style="color: #81A1C1;">'</span><span style="color: #8FBCBB;">turn-on-org-cdlatex</span><span style="color: #81A1C1;">)</span>
</pre>
</div>

<p>
y las instrucciones del paquete pueden encontrarse <a href="https://github.com/cdominik/cdlatex">aqu칤</a>.
</p>

<p>
Por otro lado, empec칠 a usar <b>yasnippets</b> en Emacs. Son c칩modos,
f치ciles de programar, y me permiten simplificar tareas como escribir
diagramas conmutativos o complejos simpliciales en pocos pasos.
</p>
</div>
</div>

<div id="outline-container-org930bd5c" class="outline-2">
<h2 id="org930bd5c">Diagramas conmutativos</h2>
<div class="outline-text-2" id="text-org930bd5c">
<p>
Ahora estoy escribiendo sobre 치lgebra homol칩gica y teor칤a de categor칤as, as칤 que
la mayor칤a de lo que escribo usa secuencias exactas y diagramas conmutativos.
</p>

<p>
Para las secuencias exactas, por ejemplo, tengo simplemente
una plantilla con <code>yasnippet</code>, que me deja 
incluirlas escribiendo <code>complex_</code> y pulsando <code>&lt;tab&gt;</code>:
</p>

<pre class="example">
  # -*- mode: snippet -*-
  # name: complex
  # key: complex_
  #--
  \begin{aligned*} $1 \overset{$6}\longrightarrow 
  $2 \overset{$7}\longrightarrow 
  $3 \overset{$8}\longrightarrow 
  $4 \overset{$9}\longrightarrow 
  $5 \end{aligned*}
</pre>

<p>
Para los diagramas conmutativos, la soluci칩n es un poco m치s
compleja. El paquete <b>tikz</b> de Latex es muy 칰til para escribirlos pero
tiene una sintaxis es demasiado recargada; as칤 que existe <b>tikz-cd</b>, que
simplifica esa sintaxis para centrarla en diagramas conmutativos. Para
usarlo, hay que empezar por incluir en el archivo de configuraci칩n
<code>init.el</code> las siguientes l칤neas
</p>

<div class="org-src-container">
<pre class="src src-lisp">(add-to-list
  'org-latex-packages-alist '(<span style="color: #A3BE8C;">""</span> <span style="color: #A3BE8C;">"tikz"</span> t))

(eval-after-load <span style="color: #A3BE8C;">"preview"</span>
  '(add-to-list
    'preview-default-preamble
    <span style="color: #A3BE8C;">"\\PreviewEnvironment{tikzpicture}"</span>
    t))
</pre>
</div>

<p>
que pueden modificarse y escribirse de forma an치loga si queremos que Emacs
use internamente otros paquetes de Latex.
</p>

<p>
Adem치s en mi caso, tuve que cambiar el programa con el que generaba
las im치genes. Parece funcionar s칩lo <b>imagemagick</b> cuando queremos
usar diagramas conmutativos
</p>

<div class="org-src-container">
<pre class="src src-lisp">     (setq org-latex-create-formula-image-program 'imagemagick)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgde94d08" class="outline-2">
<h2 id="orgde94d08">Cabeceras en Latex</h2>
<div class="outline-text-2" id="text-orgde94d08">
<p>
Cuando necesitamos funcionalidad adicional que ofrece Latex en bibliotecas aparte,
como usar <code>tikz-cd</code>, podemos incluirlas en la cabecera del archivo org como:
</p>

<p>
Adem치s, si queremos que sea funcionalidad que s칩lo se use en la exportaci칩n de
latex pero no en la previsualizaci칩n, podemos incluirla con <code>#+latex_header_extra</code>.
</p>
</div>
</div>

<div id="outline-container-org8dea95a" class="outline-2">
<h2 id="org8dea95a">Archivos de configuraci칩n de org</h2>
<div class="outline-text-2" id="text-org8dea95a">
<p>
Para evitar tener que repetir varias veces la misma cabecera en varios
archivos, podemos usar un s칩lo archivo para escribir matem치ticas y
fraccionarlo en secciones tem치ticas. Cuando necesitamos tratar una
secci칩n, podemos usar la funcionalidad de <i>narrowing</i> de <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Narrowing.html">org</a> para
tratar s칩lo una secci칩n. 
</p>

<p>
Otra opci칩n es la de tener un s칩lo archivo de configuraci칩n
<code>math.setup</code> con reglas de la forma
</p>

<p>
y cargarlo en cada archivo <code>org</code> con <code>#+SETUPFILE: math.setup</code>.
</p>
</div>
</div>

<div id="outline-container-org8e83040" class="outline-2">
<h2 id="org8e83040">Ejemplos</h2>
<div class="outline-text-2" id="text-org8e83040">
<p>
Pueden encontrarse ejemplos de uso en <a href="https://github.com/mroman42/math">este repositorio</a> con mis apuntes
de matem치ticas. Mi archivo de configuraci칩n de Emacs est치 disponible en
<a href="https://github.com/M42/.emacs.d">mroman42/emacs.d</a>.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr><p class="date">Last edited 2020-04-25 12:12:13 by Mario Rom치n (<a href="https://github.com/mroman42/cosmoi">code</a>).</p>
</div>
</body>
</html>
